<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

 <title>IFT6758 Blog</title>
 <link href="http://localhost:4000/atom.xml" rel="self"/>
 <link href="http://localhost:4000/"/>
 <updated>2022-11-25T22:29:01-05:00</updated>
 <id>http://localhost:4000</id>
 <author>
   <name>Mark Otto</name>
   <email>markdotto@gmail.com</email>
 </author>

 
 <entry>
   <title>Model Evaluation</title>
   <link href="http://localhost:4000/2022/11/24/Model-Evaluation/"/>
   <updated>2022-11-24T00:00:00-05:00</updated>
   <id>http://localhost:4000/2022/11/24/Model-Evaluation</id>
   <content type="html">&lt;h2 id=&quot;évaluer-sur-lensemble-test&quot;&gt;Évaluer sur l’ensemble test&lt;/h2&gt;

&lt;h3 id=&quot;modèles-testés-sur-la-saison-régulière&quot;&gt;Modèles testés sur la saison régulière&lt;/h3&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Saison Reguliere 2019-2020&lt;/th&gt;
      &lt;th&gt; &lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;img src=&quot;../plots/test_evaluation/roc_reg.png&quot; alt=&quot;ROC-AUC&quot; /&gt;&lt;/td&gt;
      &lt;td&gt;&lt;img src=&quot;../plots/test_evaluation/rate_reg.png&quot; alt=&quot;GOAL RATE&quot; /&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;img src=&quot;../plots/test_evaluation/prop_reg.png&quot; alt=&quot;GOAL PROPORTION&quot; /&gt;&lt;/td&gt;
      &lt;td&gt;&lt;img src=&quot;../plots/test_evaluation/positive_reg.png&quot; alt=&quot;CALIBRATION&quot; /&gt;&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;Par rapport aux résultats obtenus par l’évaluation test on voir des différences variée selon les différents modèle. Surprenamment on voit une croissance légère pour Adaboost et XGBoost de AUC et plus logiquement une decroissance, faible, de AUC pour les modèle de Logistic Regression. XGBoost et Adaboost on une AUC similaire avec XGBoost ayant rattraper le déficite et XGBoost a une plus fort certitude et variation de probabilité. Ces deux modèles performent de façon similaire sur ces données test que sur les données de validation et entre eux, avec un petit avantage du XGBoost. Les modèles de regression logistic géneralisent aussi plutôt bien.&lt;/p&gt;

&lt;h3 id=&quot;saison-des-playoffs-2019-2020&quot;&gt;Saison des playoffs 2019-2020&lt;/h3&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Test sur les playoffs 2019-2020&lt;/th&gt;
      &lt;th&gt; &lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;img src=&quot;../plots/test_evaluation/roc_playoffs.png&quot; alt=&quot;ROC-AUC&quot; /&gt;&lt;/td&gt;
      &lt;td&gt;&lt;img src=&quot;../plots/test_evaluation/rate_playoff.png&quot; alt=&quot;GOAL RATE&quot; /&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;img src=&quot;../plots/test_evaluation/prop_playoffs.png&quot; alt=&quot;GOAL PROPORTION&quot; /&gt;&lt;/td&gt;
      &lt;td&gt;&lt;img src=&quot;../plots/test_evaluation/positive_playoffs.png&quot; alt=&quot;CALIBRATION&quot; /&gt;&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;Par rapport aux données obtenus sur la saison régulière on observe une décroissance net de l’AUC pour les modèles plus complexes et une augmentation pour les regression logistiques. De plus, à l’exception du modèle utilisant seulement les angles de tir (qui avait été précédemment remarqué comme étant moins performant) ils suivent tous les 4 une courbe similaire pour le taux de tirs prédits. Finalement, la régression logistique considérant les angles et la distance se distingue comme étant plus fiable que pour d’autres données. On voit donc que les modèles d’Adaboost et XGBoost perfoment un peu moins bien que sur les données des saisons régulières mais généralisent, mais que la regression logistique considérant la distance et l’angle est surprenamment performant dans le cas d’une réel généralisation.&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Do Your Best!</title>
   <link href="http://localhost:4000/2022/11/23/Do-Your-Best!/"/>
   <updated>2022-11-23T00:00:00-05:00</updated>
   <id>http://localhost:4000/2022/11/23/Do-Your-Best!</id>
   <content type="html">&lt;h2 id=&quot;évaluation-préliminaire&quot;&gt;Évaluation Préliminaire&lt;/h2&gt;

&lt;p&gt;Notre technique d’évaluation s’est résumé en un processus à deux étapes. D’abords, nous essayons plusieurs modèles différents sans ajustage d’hyper-paramètres.&lt;/p&gt;

&lt;p&gt;Ceci nous permet de courvrir un large éventail de technique sans trop perdre de temps sur des solution peu prometteuses.&lt;/p&gt;

&lt;p&gt;Puis nous conservons les modèles un sont dans un écart de 10% de performance ROC-AUC du meilleur modèle &lt;em&gt;out-of-the-box&lt;/em&gt;.&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Modèle&lt;/th&gt;
      &lt;th&gt;Comet link&lt;/th&gt;
      &lt;th&gt;ROC-AUC&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;KNN&lt;/td&gt;
      &lt;td&gt;&lt;a href=&quot;https://www.comet.com/williamglazer/hockeyanalysis/5a66b7c2394b4e94b35c9d2a5d94c9f6&quot;&gt;url&lt;/a&gt;&lt;/td&gt;
      &lt;td&gt;.606&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Decision Tree&lt;/td&gt;
      &lt;td&gt;&lt;a href=&quot;https://www.comet.com/williamglazer/hockeyanalysis/6b6ebcf77af64cee9c5454d8d69a6cf2&quot;&gt;url&lt;/a&gt;&lt;/td&gt;
      &lt;td&gt;.537&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Random Forest&lt;/td&gt;
      &lt;td&gt;&lt;a href=&quot;https://www.comet.com/williamglazer/hockeyanalysis/3d6a8e0df0f34461b11f6e165f8bd4ad&quot;&gt;url&lt;/a&gt;&lt;/td&gt;
      &lt;td&gt;.692&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;strong&gt;AdaBoost&lt;/strong&gt;    (best)&lt;/td&gt;
      &lt;td&gt;&lt;a href=&quot;https://www.comet.com/williamglazer/hockeyanalysis/195b09dca5114ec79174f86cd46382de&quot;&gt;url&lt;/a&gt;&lt;/td&gt;
      &lt;td&gt;.&lt;strong&gt;728&lt;/strong&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Naive Bayes&lt;/td&gt;
      &lt;td&gt;&lt;a href=&quot;https://www.comet.com/williamglazer/hockeyanalysis/6ab70286a4aa42309edfc241d6e63857&quot;&gt;url&lt;/a&gt;&lt;/td&gt;
      &lt;td&gt;.714&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Quadratic Discriminant Analysis&lt;/td&gt;
      &lt;td&gt;&lt;a href=&quot;https://www.comet.com/williamglazer/hockeyanalysis/3e15ce4a2f8d423bb3fe22df3efd2a5e&quot;&gt;url&lt;/a&gt;&lt;/td&gt;
      &lt;td&gt;.714&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;XGBoost&lt;/td&gt;
      &lt;td&gt;&lt;a href=&quot;https://www.comet.com/williamglazer/hockeyanalysis/857cdd44f44e4f0b8ab33f4f1014683e&quot;&gt;url&lt;/a&gt;&lt;/td&gt;
      &lt;td&gt;.720&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;Le meilleur modèle semblait de loin être AdaBoost, nous avons donc élu celui-ci comme le seul&lt;/p&gt;

&lt;p&gt;Nos graphiques pour chaque modèle sont enregistré dans Comet.ml sous &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;assets &amp;amp; Artifacts &amp;gt; images &amp;gt; plots.svg&lt;/code&gt;. Voici un extrait du meilleur modèle AdaBoost et du pire modèle de Decision Tree&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;AdaBoost Best Model&lt;/th&gt;
      &lt;th&gt; &lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;ROC &lt;img src=&quot;https://s3.amazonaws.com/comet.ml/image_3e15ce4a2f8d423bb3fe22df3efd2a5e-dE4JTLPcoZzLi87sJttqj4pEb.svg&quot; alt=&quot;roc&quot; /&gt;&lt;/td&gt;
      &lt;td&gt;Goal Rate &lt;img src=&quot;https://s3.amazonaws.com/comet.ml/image_3e15ce4a2f8d423bb3fe22df3efd2a5e-8vspTwsE5myusII0nzSIbtXv6.svg&quot; alt=&quot;rate&quot; /&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Goal Cumulative Sum &lt;img src=&quot;https://s3.amazonaws.com/comet.ml/image_3e15ce4a2f8d423bb3fe22df3efd2a5e-HLi2gNqLeVghEDAqcmUJuOXX2.svg&quot; alt=&quot;cumsum&quot; /&gt;&lt;/td&gt;
      &lt;td&gt;Calibration &lt;img src=&quot;https://s3.amazonaws.com/comet.ml/image_3e15ce4a2f8d423bb3fe22df3efd2a5e-CWxEUTep0HUwDRbMCKGblOfvj.svg&quot; alt=&quot;calibration&quot; /&gt;&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Decision Tree Worst Model&lt;/th&gt;
      &lt;th&gt; &lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;Ces modèle n’a pas de probabilitée&lt;/td&gt;
      &lt;td&gt; &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;ROC &lt;img src=&quot;https://s3.amazonaws.com/comet.ml/image_6b6ebcf77af64cee9c5454d8d69a6cf2-jv53HKFXDis9tTF638Er5Yq7n.svg&quot; alt=&quot;roc&quot; /&gt;&lt;/td&gt;
      &lt;td&gt;Calibration &lt;img src=&quot;https://s3.amazonaws.com/comet.ml/image_6b6ebcf77af64cee9c5454d8d69a6cf2-SFcJYgNvort0c4R8UOUMBBLHH.svg&quot; alt=&quot;calibration&quot; /&gt;&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h2 id=&quot;recherche-dhyper-paramètres&quot;&gt;Recherche d’Hyper Paramètres&lt;/h2&gt;

&lt;p&gt;&lt;a href=&quot;https://www.comet.com/williamglazer/hockeyanalysis/e653e4860266487eae799e75133fbda7?experiment-tab=chart&amp;amp;showOutliers=true&amp;amp;smoothing=0&amp;amp;transformY=smoothing&amp;amp;xAxis=step&quot;&gt;Comet.ml&lt;/a&gt;&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Parameter&lt;/th&gt;
      &lt;th&gt;Values&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;base learner max depth&lt;/td&gt;
      &lt;td&gt;[1,2,3]&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;base learner&lt;/td&gt;
      &lt;td&gt;Decision Treee Clf&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;learning rate&lt;/td&gt;
      &lt;td&gt;[0.1, 1, 10]&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;n estimators&lt;/td&gt;
      &lt;td&gt;[25, 50, 75]&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;Notre meilleure modèle s’avère être:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;{
   &apos;adaboost__base_estimator&apos;: DecisionTreeClassifier(max_depth=3),
   &apos;adaboost__learning_rate&apos;: 0.1,
   &apos;adaboost__n_estimators&apos;: 75
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;avec un ROC-AUC de &lt;strong&gt;.739&lt;/strong&gt; ce qui est une faible augmentation de +.002.&lt;/p&gt;

&lt;h2 id=&quot;stratified-sampling&quot;&gt;Stratified Sampling&lt;/h2&gt;

&lt;p&gt;&lt;a href=&quot;https://www.comet.com/williamglazer/hockeyanalysis/e91356fedb86466fad342357d034a4fe&quot;&gt;Comet.ml&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Notre dernière tentative est de stratifier nos exemples d’entrainement à travers les années afin d’avoir une meilleur représentation de nos performances&lt;/p&gt;

&lt;p&gt;Nos performances n’ont pas augmenté&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Modèles Avancés</title>
   <link href="http://localhost:4000/2022/11/22/Mod%C3%A8les-Avanc%C3%A9s/"/>
   <updated>2022-11-22T00:00:00-05:00</updated>
   <id>http://localhost:4000/2022/11/22/Modèles-Avancés</id>
   <content type="html">&lt;h2 id=&quot;xgboost-sur-angle--distance&quot;&gt;XGBoost sur Angle &amp;amp; Distance&lt;/h2&gt;

&lt;p&gt;&lt;a href=&quot;https://www.comet.com/williamglazer/hockeyanalysis/00655e4eece64684bc945bbc447ebc72?experiment-tab=chart&amp;amp;showOutliers=true&amp;amp;smoothing=0&amp;amp;transformY=smoothing&amp;amp;xAxis=wall&quot;&gt;Comet.ml&lt;/a&gt;&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;XGBoost&lt;/th&gt;
      &lt;th&gt; &lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;img src=&quot;../plots/roc_xgb.png&quot; alt=&quot;ROC-AUC&quot; /&gt;&lt;/td&gt;
      &lt;td&gt;&lt;img src=&quot;../plots/rate_xgb.png&quot; alt=&quot;GOAL RATE&quot; /&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;img src=&quot;../plots/prop_xgb.png&quot; alt=&quot;GOAL PROPORTION&quot; /&gt;&lt;/td&gt;
      &lt;td&gt;&lt;img src=&quot;../plots/calibration_xgb.png&quot; alt=&quot;CALIBRATION&quot; /&gt;&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Logistic Reg&lt;/th&gt;
      &lt;th&gt; &lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;img src=&quot;../plots/roc_logreg.png&quot; alt=&quot;ROC-AUC&quot; /&gt;&lt;/td&gt;
      &lt;td&gt;&lt;img src=&quot;../plots/goal_rate_logreg.png&quot; alt=&quot;GOAL RATE&quot; /&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;img src=&quot;../plots/goal_prop_logreg.png&quot; alt=&quot;GOAL PROPORTION&quot; /&gt;&lt;/td&gt;
      &lt;td&gt;&lt;img src=&quot;../plots/calibration_logreg.png&quot; alt=&quot;CALIBRATION&quot; /&gt;&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;On peut voir qu’XGBoost obtiens des performances similaire en terme d’AUC. Par contre, nous pouvons facilement voir que les graphiques de calibration montrent qu’XGBoost tends à preédire différentes probabilitées tandisque la régression logistique prédit beaucoup plus souvent des probabilitées faibles. Nous pouvons donc déterminer que le modèle XGBoost est meilleur puisque nous voulons modéliser la probabilitée d’un tir.&lt;/p&gt;

&lt;h2 id=&quot;optimisation-dhyper-paramètres-xgbooost&quot;&gt;Optimisation d’Hyper-paramètres XGBooost&lt;/h2&gt;

&lt;p&gt;&lt;a href=&quot;https://www.comet.com/williamglazer/hockeyanalysis/1c85a5219e674091b97fcf33ceec5b3d?experiment-tab=chart&amp;amp;showOutliers=true&amp;amp;smoothing=0&amp;amp;transformY=smoothing&amp;amp;xAxis=step&quot;&gt;Comet.ml&lt;/a&gt;&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;XGBoost Best Model&lt;/th&gt;
      &lt;th&gt; &lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;img src=&quot;../plots/roc_best_xgb.png&quot; alt=&quot;ROC-AUC&quot; /&gt;&lt;/td&gt;
      &lt;td&gt;&lt;img src=&quot;../plots/rate_best_xgb.png&quot; alt=&quot;GOAL RATE&quot; /&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;img src=&quot;../plots/prop_best_xgb.png&quot; alt=&quot;GOAL PROPORTION&quot; /&gt;&lt;/td&gt;
      &lt;td&gt;&lt;img src=&quot;../plots/calibration_best_xgb.png&quot; alt=&quot;CALIBRATION&quot; /&gt;&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;On peut voir que notre modèle est beaucoup plus performant sur la courbe de calibration et parvient à bien prédire la probabilitée de plusieurs événements. Il est tout de même faible autour de .7 de probabilitée. Les autres métriques sont assez similaires.&lt;/p&gt;

&lt;p&gt;Pour nos expériences, nous procédons à un gridsearch naif sur les paramètres les plus populaires. Notre meilleur modèle est enregistré dans Comet. Nous utilisons &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;sklearn.Pipeline&lt;/code&gt; et &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;sklearn.GridSearchCV&lt;/code&gt; afin d’entrainer et d’évaluer nos modèles.
Ceci nous permet de faire une validation croisée et d’approximer efficacement nos performances.&lt;/p&gt;

&lt;p&gt;Voici notre grille d’hyper-paramètres:&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Parameter&lt;/th&gt;
      &lt;th&gt;Values&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;learning rate&lt;/td&gt;
      &lt;td&gt;[0.2, 0.01, 0.001]&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;depth&lt;/td&gt;
      &lt;td&gt;[3, 6, 10]&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;n estimators&lt;/td&gt;
      &lt;td&gt;[50, 75, 100]&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;Notre meilleure modèle s’avère être:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;{
    &apos;xgb_model__eval_metric&apos;: &apos;logloss&apos;,
    &apos;xgb_model__learning_rate&apos;: 0.2,
    &apos;xgb_model__max_depth&apos;: 3,
    &apos;xgb_model__min_child_weight&apos;: 1,
    &apos;xgb_model__n_estimators&apos;: 100,
    &apos;xgb_model__objective&apos;: &apos;binary:logistic&apos;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;avec un ROC-AUC de &lt;strong&gt;.737&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Nous pourrions améliorer nos résultats en utilisant des méthodes de recherche telle que vues en classe comme les recherche bayésiennes ou aléatoires.&lt;/p&gt;

&lt;h2 id=&quot;sélection-de-caractéristiques&quot;&gt;Sélection de Caractéristiques&lt;/h2&gt;

&lt;p&gt;&lt;a href=&quot;https://www.comet.com/williamglazer/hockeyanalysis/857cdd44f44e4f0b8ab33f4f1014683e?experiment-tab=params&quot;&gt;Comet.ml&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Nous utilisons une technbique de filtrage qui utilise notre algorithme XGBoost. Nous entrainons nootre modèle sur toutes les caractéristiques et nous enlevons celle ayant le moins hait score d’importance.&lt;/p&gt;

&lt;p&gt;Le score d’importance de caractéristique est une mesure relative du nombre de fois qu’une caractéristique est utlisée afin de faire un split dans un arbre. Ce n’est pas la métrique la plus élégante, mais c’est assez pour nous suffire.&lt;/p&gt;

&lt;p&gt;Ainsi notre processus est de :&lt;/p&gt;
&lt;ol&gt;
  &lt;li&gt;Entrainer le modèle sur les caractéristiques&lt;/li&gt;
  &lt;li&gt;Évaluer la performance ROC-AUC&lt;/li&gt;
  &lt;li&gt;Identifier la caractéristique avec la plus faible importance&lt;/li&gt;
  &lt;li&gt;Re-faire l’étape 1 sans la caractéristique la moins importante&lt;/li&gt;
  &lt;li&gt;Arrêter si notre ROC-AUC baisse de plus de 1%&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;De toutes les caractéristiques que nous avions, nous éléminons rebound et gardons celles en gras:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;shot_distance&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;shot_angle&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;dist_prev_event&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;time_lapsed_prev_event_in_seconds&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;game_secs&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;rebound&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Voici le graphique d’importance des caractéristique:
&lt;img src=&quot;../plots/feat_imp.png&quot; alt=&quot;feature-imp&quot; /&gt;&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;XGBoost Less Features&lt;/th&gt;
      &lt;th&gt; &lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;img src=&quot;../plots/roc_xgb_feat.png&quot; alt=&quot;ROC-AUC&quot; /&gt;&lt;/td&gt;
      &lt;td&gt;&lt;img src=&quot;../plots/rate_xgb_feat.png&quot; alt=&quot;GOAL RATE&quot; /&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;img src=&quot;../plots/prop_xgb_feat.png&quot; alt=&quot;GOAL PROPORTION&quot; /&gt;&lt;/td&gt;
      &lt;td&gt;&lt;img src=&quot;../plots/calibration_xgb_feat.png&quot; alt=&quot;CALIBRATION&quot; /&gt;&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
</content>
 </entry>
 
 <entry>
   <title>Ingénierie Des Caractéristiques 2</title>
   <link href="http://localhost:4000/2022/11/21/Ing%C3%A9nierie-des-caract%C3%A9ristiques-2/"/>
   <updated>2022-11-21T00:00:00-05:00</updated>
   <id>http://localhost:4000/2022/11/21/Ingénierie-des-caractéristiques-2</id>
   <content type="html">&lt;h2 id=&quot;caracteristiques-créées&quot;&gt;Caracteristiques Créées&lt;/h2&gt;

&lt;p&gt;&lt;a href=&quot;https://www.comet.com/williamglazer/hockeyanalysis/7bc807a88fb649d4a28beed00d2b5faf?experiment-tab=assets&quot;&gt;Expérience WPG V WSH&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&quot;caracteristiques-issue-de-ingé-i&quot;&gt;Caracteristiques issue de Ingé I&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;goal&lt;/code&gt;:Est un but (0 ou 1)&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;empty_net&lt;/code&gt;: Filet vide (0 ou 1, vous pouvez supposons que les NaN sont 0)&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;game_secs&lt;/code&gt;: Secondes de jeu (Game seconds)&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;period&lt;/code&gt;: Période de jeu (Game period)&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;x_coords&lt;/code&gt;, ‘y_coords’: Coordonnées (x,y, colonnes séparées)&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;shot_distance&lt;/code&gt;: Distance de tir (Shot distance)&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;shot_angle&lt;/code&gt;: Angle de tir (Shot angle)&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;shot_type&lt;/code&gt;: Type de tir (Shot type)&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;fondée-sur-levenement-précédent&quot;&gt;Fondée sur l’evenement précédent:&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;prev_type&lt;/code&gt;: Dernier type d’événement (Last event type)&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;prev_x_coords&lt;/code&gt;, ‘prev_y_coords’: Coordonnées du dernier événement (x, y, colonnes séparées)&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;prev_datetime&lt;/code&gt;: Temps de l’evenement précédent&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;time_lapsed_prev_event_in_seconds&lt;/code&gt;: Temps écoulé depuis le dernier événement (secondes)&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;dist_prev_event&lt;/code&gt;: Distance depuis le dernier événement (Distance from the last event)&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;rebound&lt;/code&gt;: Rebond (bool) : Vrai si le dernier événement était aussi un tir, sinon False&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;angle_change&lt;/code&gt;: Changement d’angle de tir: Inclure seulement si le tir est un rebond, sinon 0.&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;speed&lt;/code&gt;: Vitesse&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;autres&quot;&gt;Autres&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;season&lt;/code&gt;: Saison&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;game_starttime&lt;/code&gt;, ‘game_endtime’: Moment de début et de fin du jeu (format datetime: date, heure, minute, secondes)&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;game_id&lt;/code&gt;: Code/Id du jeu&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;datetime&lt;/code&gt;: Moment de l’évenement&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;offense_team_id&lt;/code&gt;, ‘offense_team_name’, ‘offense_team_tricode’: Informations de l’équipe offensive (Id, Nom, Tricode, colonnes séparées)&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;shooter_name&lt;/code&gt;: Nom du tireur&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;shooter_id&lt;/code&gt;: Id du tireur&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;goalie_name&lt;/code&gt;: Nom du gardien&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;goalie_id&lt;/code&gt;: Id du gardien&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;period_time&lt;/code&gt;: Temps en secondes depuis le debut de la periode&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;strength_shorthand&lt;/code&gt;, ‘strength_even’, ‘strength_powerplay’ : One-Hot-Encoding (1 si vrai 0 si faux) de la force en nombre des equipes&lt;/li&gt;
&lt;/ul&gt;

</content>
 </entry>
 
 <entry>
   <title>Modèle Simples</title>
   <link href="http://localhost:4000/2022/11/20/Mod%C3%A8le-Simples/"/>
   <updated>2022-11-20T00:00:00-05:00</updated>
   <id>http://localhost:4000/2022/11/20/Modèle-Simples</id>
   <content type="html">&lt;h2 id=&quot;régression-logistique-simple&quot;&gt;Régression Logistique Simple&lt;/h2&gt;

&lt;p&gt;On remarque que notre classificateur obtiens une bonne performance, soit .90 d’accuracy. Pourtant, lorsqu’on observe les résultats, On remaruqe que 100% des prédictions sont de la classe 0 dû à un d.balancement dans le jeu de donnée d’entraînement.&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt; &lt;/th&gt;
      &lt;th&gt; &lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;img src=&quot;../plots/roc_logreg.png&quot; alt=&quot;ROC-AUC&quot; /&gt;&lt;/td&gt;
      &lt;td&gt;&lt;img src=&quot;../plots/goal_rate_logreg.png&quot; alt=&quot;GOAL RATE&quot; /&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;img src=&quot;../plots/goal_prop_logreg.png&quot; alt=&quot;GOAL PROPORTION&quot; /&gt;&lt;/td&gt;
      &lt;td&gt;&lt;img src=&quot;../plots/calibration_logreg.png&quot; alt=&quot;CALIBRATION&quot; /&gt;&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;De ces graphes, on peut déduire que la distance au but est nécessaire afin d’obtenir de bonnes performances. Le modèle qui contiens uniquement l’angle se différencie à peine du &lt;em&gt;baseline&lt;/em&gt; aléatoire.
On peut aussi voir qu’utilise l’angle et la distance est un peu supérieur à la distance seule.
Pour faire ces conclusions, nous nous basons surtout sur la courbe ROC ainsi que la métrique AUC qui sera utilisée pour nos évaluations de modèles.&lt;/p&gt;

&lt;p&gt;La courbe de calibration montre que nos modèles ne prédisent la classe 0 avec une probabilitée très faible.&lt;/p&gt;

&lt;p&gt;Les courbes de goal rate montrent que nos modèles avec la distance battent des performances aléatoires.&lt;/p&gt;

&lt;p&gt;Voici les liens vers nos expériences Comet.ml:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.comet.com/williamglazer/hockeyanalysis/1ba10a235fc54b1cb7c3442ffd1fa732?experiment-tab=params&quot;&gt;Distance&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.comet.com/williamglazer/hockeyanalysis/53f79ca0ebac43bb919be4a484e943f2?experiment-tab=params&quot;&gt;Angle&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.comet.com/williamglazer/hockeyanalysis/1fa1831453114073a58a32c623ed8fc4?experiment-tab=params&quot;&gt;Distance &amp;amp; Angle&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</content>
 </entry>
 
 <entry>
   <title>Ingénierie Des Caractéristiques 1</title>
   <link href="http://localhost:4000/2022/11/19/Ing%C3%A9nierie-des-caract%C3%A9ristiques-1/"/>
   <updated>2022-11-19T00:00:00-05:00</updated>
   <id>http://localhost:4000/2022/11/19/Ingénierie-des-caractéristiques-1</id>
   <content type="html">&lt;h2 id=&quot;nombre-de-tirs-vs-distance&quot;&gt;Nombre de tirs vs. distance&lt;/h2&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Tir Réussits&lt;/th&gt;
      &lt;th&gt;Tirs Manqués&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;img src=&quot;../plots/successful_goals_by_dist.png&quot; alt=&quot;nombre de tirs vs distance&quot; /&gt;&lt;/td&gt;
      &lt;td&gt;&lt;img src=&quot;../plots/unsuccessful_goals_by_dist.png&quot; alt=&quot;nombre de tirs vs distance&quot; /&gt;&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;On remarque facilement que les tirs réussits sont majoritairement proches, soit dans la zone des 10-20 mètres. Plus la distance augmente, plus les tirs réussis sont rares. Pour ce qui est des tirs manqués, la distribution semble assez uniforme. Par contre on a un pic proche du but puisque nous savons que plusieurs buts sont marqués de près, donc il vaut la pein d’en essayer plus. finalement, la ligne du &lt;em&gt;offside&lt;/em&gt; fait en sorte que peu de buts sont tentés au-delà de 70m.&lt;/p&gt;

&lt;h2 id=&quot;nombre-de-tirs-vs-angle&quot;&gt;Nombre de tirs vs. angle&lt;/h2&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Tir Réussits&lt;/th&gt;
      &lt;th&gt;Tirs Manqués&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;img src=&quot;../plots/successful_goals_by_angle.png&quot; alt=&quot;nombre de tirs vs distance&quot; /&gt;&lt;/td&gt;
      &lt;td&gt;&lt;img src=&quot;../plots/unsuccessful_goals_by_angle.png&quot; alt=&quot;nombre de tirs vs distance&quot; /&gt;&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;Nous avons choisis de traiter l’angle comme un angle par rapport à la droite qui passe d’un bout à l’autre du but. Quelqu’un en face dut but a donc un angle de 90 degrés. Il est donc normal de trouver peu de buts avec un angle de 0 selon notre intuition. Il est intéressant de voir que les distributions de but réussits et manqués sont presques identiques hormis un pic de tirs manqués vers les 60 degrés. On peut aussi voir que l’anfgle avec le plut haut taux de succès est d’être directement en face du gardien.&lt;/p&gt;

&lt;h2 id=&quot;histogramme-2d-entre-la-distance-et-langle&quot;&gt;Histogramme 2D entre la distance et l’angle&lt;/h2&gt;

&lt;h1 align=&quot;center&quot;&gt;
&lt;img src=&quot;../plots/distance-vs-angle.png&quot; /&gt;
&lt;/h1&gt;

&lt;p&gt;Il est intéressant de constater que la majorité des tirs sont effectués à une distance de 20m du gardien et devant celui-ci. On remarque aussi que plus la distance au but est petite, plus l’angle se doit d’être en face du gardien, sinon on risque de frapper un poteau car le gardien peut bloquer l’entièretée du but.&lt;/p&gt;

&lt;h2 id=&quot;taux-de-but-à-la-distanceangle&quot;&gt;Taux de but à la distance/angle&lt;/h2&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Angle&lt;/th&gt;
      &lt;th&gt;Distance&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;img src=&quot;../plots/goal_rate_distance.png&quot; alt=&quot;nombre de tirs vs distance&quot; /&gt;&lt;/td&gt;
      &lt;td&gt;&lt;img src=&quot;../plots/goal_rate_angle.png&quot; alt=&quot;nombre de tirs vs distance&quot; /&gt;&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;On peut voir que le taux de succès est beaucoup plus grand lorsque l’on s’approche du but. On apercoit aussi une anomalie dans les données du a un &lt;em&gt;outlier&lt;/em&gt; qui fait en sorte qu’on obtiens 80% de succès à moins d’un mètre du but.&lt;/p&gt;

&lt;p&gt;Pour ce qui est de l’angle, on voit une tendance qui indique que plus l’angle est proche d’être en face du gardien, plus le taux de succès est grand. C’est logique puisque quand on tir de coté, le gardien recouvre la majoritée du but.&lt;/p&gt;

&lt;h1 id=&quot;but-par-distance-par-rapport-de-fillet-vide-ou-non-vide&quot;&gt;But par distance par rapport de fillet vide ou non vide&lt;/h1&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;But Vides&lt;/th&gt;
      &lt;th&gt;Buts Avec Gardien&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;img src=&quot;../plots/goals_empty_net.png&quot; alt=&quot;fillet vide&quot; /&gt;&lt;/td&gt;
      &lt;td&gt;&lt;img src=&quot;../plots/goals_not_empty_net.png&quot; alt=&quot;fillet non vide&quot; /&gt;&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;La distribution des buts vides est presque uniforme quoiqu’un peu plus difficle lorsque l’on tire de loin. Les buts avec gardiens quant à eux sont beaucoup plus faciles à réaliser de près.&lt;/p&gt;

&lt;p&gt;Notre prétraitement enlève les anomalies dans les données (tirs de la mauvaise zone). Nous ne trouvons donc aucune anomalie dans notre graphe dû à notre connaissance du domaine injectée dans notre pré-traitement.&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Visualizations Complexes</title>
   <link href="http://localhost:4000/2022/10/19/visu-complexe/"/>
   <updated>2022-10-19T00:00:00-04:00</updated>
   <id>http://localhost:4000/2022/10/19/visu-complexe</id>
   <content type="html">&lt;!--
Exportez les 4 tracés de zone offensive au format HTML et intégrez-les dans votre article de blog. Votre parcelle doit permettre aux utilisateurs de sélectionner n’importe quelle équipe au cours de la saison sélectionnée. Note: Parce que vous pouvez trouver ces chiffres sur internet, répondre à ces questions sans produire ces chiffres ne vous rapportera pas de points !
--&gt;

&lt;h2 id=&quot;densité-de-tirs&quot;&gt;Densité de tirs&lt;/h2&gt;

&lt;p&gt;Le graphique montre la densité de tirs sur la glace pour une équipe/saison donnée. La moyenne (blanche) est la moyenne de tirs de toutes les équipes pour une saison donnée. On peut voir les régions chaudes (en rouge) qui représentent des régions ou plus de but ont été marqués que la moyenne des équipe. En bleu on a l’opposé, soit en-dessous de la moyenne.&lt;/p&gt;

&lt;p&gt;Dans ces graphes, on peut voir de quel régions les différentes équipes arrivent à marquer leurs buts. Est-ce qu’il s’agit d’une équipe qui amrque beaucoup de buts à proximitée de manière aggresive, qui domine le centre de la glace, ou est-ce plutôt une équipe qui préfère tirer souvent, mais de loin avec des coups du poignet.&lt;/p&gt;

&lt;p&gt;Ceci nous permet de voir l’efficacité des startégies et les différentes faiblesses des équipes.&lt;/p&gt;

&lt;p&gt;Select Season&lt;br /&gt;
Fixed to 2016-2018 for hand-in due to filesize exceeding gradescope limits otherwise&lt;/p&gt;

&lt;p&gt;&lt;select id=&quot;season&quot; onchange=&quot;refreshplot()&quot;&gt;
	&lt;option value=&quot;20162017&quot;&gt;2016-2017&lt;/option&gt;
	&lt;option value=&quot;20172018&quot;&gt;2017-2018&lt;/option&gt;
&lt;/select&gt;&lt;/p&gt;

&lt;p&gt;Select Team 
&lt;select id=&quot;team&quot; onchange=&quot;refreshplot()&quot;&gt;
	&lt;option value=&quot;&quot;&gt;..&lt;/option&gt;
	&lt;option value=&quot;ANA&quot;&gt;Mighty Ducks of Anaheim/Anaheim Ducks&lt;/option&gt;
	&lt;option value=&quot;ARI&quot;&gt;Arizona Coyotes&lt;/option&gt;
	&lt;option value=&quot;BOS&quot;&gt;Boston Bruins&lt;/option&gt;
	&lt;option value=&quot;BUF&quot;&gt;Buffalo Sabres&lt;/option&gt;
	&lt;option value=&quot;CAR&quot;&gt;Carolina Hurricanes&lt;/option&gt;
	&lt;option value=&quot;CBJ&quot;&gt;Columbus Blue Jackets&lt;/option&gt;
	&lt;option value=&quot;CGY&quot;&gt;Calgary Flames&lt;/option&gt;
	&lt;option value=&quot;CHI&quot;&gt;Chicago Black Hawks/Blackhawks&lt;/option&gt;
	&lt;option value=&quot;COL&quot;&gt;Colorado Avalanche&lt;/option&gt;
	&lt;option value=&quot;DAL&quot;&gt;Dallas Stars&lt;/option&gt;
	&lt;option value=&quot;DET&quot;&gt;Detroit Red Wings&lt;/option&gt;
	&lt;option value=&quot;EDM&quot;&gt;Edmonton Oilers&lt;/option&gt;
	&lt;option value=&quot;FLA&quot;&gt;Florida Panthers&lt;/option&gt;
	&lt;option value=&quot;LAK&quot;&gt;Los Angeles Kings&lt;/option&gt;
	&lt;option value=&quot;MIN&quot;&gt;Minnesota Wild&lt;/option&gt;
	&lt;option value=&quot;MTL&quot;&gt;Montreal Canadiens&lt;/option&gt;
	&lt;option value=&quot;NJD&quot;&gt;New Jersey Devils&lt;/option&gt;
	&lt;option value=&quot;NSH&quot;&gt;Nashville Predators&lt;/option&gt;
	&lt;option value=&quot;NYI&quot;&gt;New York Islanders&lt;/option&gt;
	&lt;option value=&quot;NYR&quot;&gt;New York Rangers&lt;/option&gt;
	&lt;option value=&quot;OTT&quot;&gt;Ottawa Senators&lt;/option&gt;
	&lt;option value=&quot;PHI&quot;&gt;Philadelphia Flyers&lt;/option&gt;
	&lt;option value=&quot;PIT&quot;&gt;Pittsburgh Penguins&lt;/option&gt;
	&lt;option value=&quot;SJS&quot;&gt;San Jose Sharks&lt;/option&gt;
	&lt;option value=&quot;STL&quot;&gt;St. Louis Blues&lt;/option&gt;
	&lt;option value=&quot;TBL&quot;&gt;Tampa Bay Lightning&lt;/option&gt;
	&lt;option value=&quot;TOR&quot;&gt;Toronto Maple Leafs&lt;/option&gt;
	&lt;option value=&quot;VAN&quot;&gt;Vancouver Canucks&lt;/option&gt;
	&lt;option value=&quot;WPG&quot;&gt;Winnipeg Jets&lt;/option&gt;
	&lt;option value=&quot;WSH&quot;&gt;Washington Capitals&lt;/option&gt;
&lt;/select&gt;&lt;/p&gt;
&lt;iframe id=&quot;iframe&quot; src=&quot;/plots/blank.html&quot; style=&quot;height:830px;width:100%; border:dotted 1px #999;&quot; title=&quot;plot&quot;&gt;&lt;/iframe&gt;
&lt;script&gt;
	function refreshplot(){
		let season = document.getElementById(&apos;season&apos;).value;
		let team   = document.getElementById(&apos;team&apos;).value;
		let ifrm   = document.getElementById(&apos;iframe&apos;);
        if((season==&apos;&apos;)||(team==&apos;&apos;)){
            ifrm.src = &apos;plots/blank.html&apos;;
        }else{
        	ifrm.src = &apos;plots/plotly_&apos;+season+&apos;_&apos;+team+&apos;.html&apos;;
        }
	}
&lt;/script&gt;

&lt;hr /&gt;

&lt;!--
Considérez l’Avalanche du Colorado; jetez un œil à leur carte de tir au cours de la saison 2016-17. Discutez de ce que vous pourriez dire sur l’équipe au cours de cette saison. Regardez maintenant la carte des plans de l’Avalanche du Colorado pour la saison 2020-21 et discutez de ce que vous pourriez conclure de ces différences. Est-ce que ça a du sens? Astuce : regardez le classement.
--&gt;
&lt;h3 id=&quot;avalanche-colorado--une-stratégie-gagnante&quot;&gt;Avalanche Colorado : une stratégie gagnante&lt;/h3&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Season 2016-2017&lt;/th&gt;
      &lt;th&gt;season 2020-2021&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;img src=&quot;plots/COL_2016.png&quot; alt=&quot;2016-2017&quot; /&gt;&lt;/td&gt;
      &lt;td&gt;&lt;img src=&quot;plots/COL_2020.png&quot; alt=&quot;2020-2021&quot; /&gt;&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;Les avalanches se situaient en dernière place de leur division en 2016-2017 et on fait une remontée fulgurante en 2020-2021 pour se hisser au top de leur classement. On peut voir qu’ils avaient de la difficulté auparavant à s’approcher du gardien et que la majoritée de leurs buts étaient marqués de loin.&lt;/p&gt;

&lt;p&gt;Leur stratégie dans la dernière saison a beaucoup évoluée et ils sont désormais capables de s’approcher du but ce qui leur donne davantage d’occasions de marquer.&lt;/p&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;buffalo-sabres-vs-tampa-lighting&quot;&gt;Buffalo Sabres vs. Tampa Lighting&lt;/h3&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Year&lt;/th&gt;
      &lt;th&gt;Buffalo Sabres&lt;/th&gt;
      &lt;th&gt;Tampa Lighting&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;2018-2019&lt;/td&gt;
      &lt;td&gt;&lt;img src=&quot;plots/BUF_2018.png&quot; alt=&quot;2018&quot; /&gt;&lt;/td&gt;
      &lt;td&gt;&lt;img src=&quot;plots/TBL_2018.png&quot; alt=&quot;2018&quot; /&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2019-2020&lt;/td&gt;
      &lt;td&gt;&lt;img src=&quot;plots/BUF_2019.png&quot; alt=&quot;2019&quot; /&gt;&lt;/td&gt;
      &lt;td&gt;&lt;img src=&quot;plots/TBL_2019.png&quot; alt=&quot;2019&quot; /&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2020-2021&lt;/td&gt;
      &lt;td&gt;&lt;img src=&quot;plots/BUF_2020.png&quot; alt=&quot;2020&quot; /&gt;&lt;/td&gt;
      &lt;td&gt;&lt;img src=&quot;plots/TBL_2020.png&quot; alt=&quot;2020&quot; /&gt;&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;La comparaison côte-à-côte montre que le Lightning, qui connait beaucoup de succès, priorise des tris proche du centre de la glace et proche du gardien. Ils réussissent donc à déjouer la défence et s’approcher du but, ce qui leur donne un beaucoup plus haut taux de succès.&lt;/p&gt;

&lt;p&gt;Buffalo quand a eux on des tirs beaucoup plus disparates avec un faible taux de succès. Leurs régions à haute densitée de succès sont beaucoup plus disparates.&lt;/p&gt;

&lt;p&gt;Il semble facile d’expliquer la différence de perforamnce selon ces graphiques!&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Visualisations simples</title>
   <link href="http://localhost:4000/2022/10/18/visu-simple/"/>
   <updated>2022-10-18T00:00:00-04:00</updated>
   <id>http://localhost:4000/2022/10/18/visu-simple</id>
   <content type="html">&lt;h2 id=&quot;types-de-tir&quot;&gt;Types de tir&lt;/h2&gt;

&lt;p&gt;Dans le respect des consignes, qui exigeaient de superposer le nombre de tirs et le nombre de buts de chaque type, nous avons réalisé un diagramme à barres empilées où chaque barre représente un type de tir. Cependant, puique plusieurs questions ont été posé en même temps, il est évident qu’un graphique par question serait idéal.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;figures/q5-1.png&quot; alt=&quot;Histogramme des tirs et buts en fonction du type de tir (saison 2016-2017)&quot; /&gt;&lt;/p&gt;

&lt;p&gt;On constate que le &lt;em&gt;wrist shot&lt;/em&gt; est le type le plus courant, suivi loin derrière par les &lt;em&gt;slap shots&lt;/em&gt; et les &lt;em&gt;snap shots&lt;/em&gt;. Le diagramme montre que &lt;em&gt;wrist shots&lt;/em&gt; et les &lt;em&gt;snap shots&lt;/em&gt; sont particulièrement redoutables en termes absolut. Par contre les données démontrent que ce ne sont pas les types de tir qui se traduisent par le plus haut taux de succès.&lt;/p&gt;

&lt;p&gt;Une visualisation combinant, par exemple, une barre représentant le nombre de tirs de chaque type accompagné d’une ligne représentant la &lt;em&gt;proportion&lt;/em&gt; de ces tirs résultant en un but aurait été plus parlante, et aurait par exemple révélé que les types de tir les plus redoutables sont &lt;em&gt;deflected&lt;/em&gt; et &lt;em&gt;tip-in&lt;/em&gt;.&lt;/p&gt;

&lt;h2 id=&quot;distance-de-tir&quot;&gt;Distance de tir&lt;/h2&gt;

&lt;p&gt;Pour cette question, nous avons choisi de présenter des histogrammes, où chaque barre représente une classe de distances et indique la proportion de tirs se traduisant en buts. Initialement, nous avions laissé à la bibliothèque pandas le soin  de délimiter les classes, mais le résultat nuisait à la lisibilité. Si nous avions utilisé des quartiles, nous aurions perdu certaines nuances intéressantes dans les données. Les déciles auraient donné des bornes moins interprétables pour les classes. Au final, nous avons opté pour des classes représentant chacune un intervalle de dix pieds de distance.&lt;/p&gt;

&lt;p&gt;On voit dans l’ensemble que, jusqu’à une distance de 70 pieds, plus un tir est effectué proche de la cible, plus il a de chances de se traduire en but. Ce n’est pas un constat très surprenant, car on peut penser qu’il est plus facile de viser avec précision d’une distance moins grande, et que de plus moins de joueurs ont l’opportunité de s’interposer entre le tireur et le gardien pour tenter d’intercepter la rondelle.&lt;/p&gt;

&lt;p&gt;En regardant les graphiques, on constate cependant deux phénomènes étonnants.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;figures/q5-2-20182019.png&quot; alt=&quot;Histogramme des buts en fonction de la distance (saison 2018-2019)&quot; /&gt;
&lt;img src=&quot;figures/q5-2-20192020.png&quot; alt=&quot;Histogramme des buts en fonction de la distance (saison 2019-2020)&quot; /&gt;
&lt;img src=&quot;figures/q5-2-20202021.png&quot; alt=&quot;Histogramme des buts en fonction de la distance (saison 2020-2021)&quot; /&gt;&lt;/p&gt;

&lt;p&gt;D’une part, au-delà de 70 pieds, les tirs semblent reprendre en efficacité. En effet, de 2018 à 2022, les tirs d’entre 90 et 100 pieds sont en fait plus efficaces que les tirs d’entre 40 et 50 pieds. En 2020-2021, ce sont plutôt les tirs d’entre 80 et 90 pieds qui présentent cette caractéristique. Dans toutes ces années, les tirs de plus de 70 pieds de distance sont plus efficaces en moyenne que ceux de 60 à 70 pieds. La présente visualisation ne permet par contre par de tenir compte de différents facteurs qui pourraient expliquer cela. Par exemple, est-il possible que les attaquants aient une propension plus grande à tirer de loin dans un filet désert, ou encore quand, suite à une échappée, ils ne font pas face à des défenseurs qui pourraient s’interposer? Ces deux facteurs et d’autres sans doute permettraient d’expliquer au moins en partie pourquoi les tirs de loin semblent plus efficaces que ceux de distance moyenne.&lt;/p&gt;

&lt;p&gt;D’autre part, on remarque une différence assez importante au niveau du taux de succès des tirs les plus proches entre la saison 2018-2019 et les saisons subséquentes. Sur la base des donnés à notre disposition, nous ne nous considérons pas en mesure de faire d’hypothèses sur la raison qui explique cette différence.&lt;/p&gt;

&lt;h2 id=&quot;types-et-distance-de-tir&quot;&gt;Types et distance de tir&lt;/h2&gt;

&lt;p&gt;Nous avons utilisé deux types de visualisation pour cette question. Le diagramme en aires est plus facile à lire de façon générale, mais certains &lt;em&gt;insights&lt;/em&gt; n’en ressortent pas aussi bien. Un diagramme tridimensionnel présentant la distance et le type de tir sur chacun des deux axes horizontaux et la proportion de succès sur l’axe vertical est plus difficile à lire, mais fait ressortir certains points intéressants.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;figures/q5-3.png&quot; alt=&quot;Graphie en aires des buts en fonction du type de tir et de la distance (saison 2016-2017)&quot; /&gt;
&lt;img src=&quot;figures/q5-3-stacked.png&quot; alt=&quot;Graphie en aires des buts en fonction du type de tir et de la distance (saison 2016-2017)&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Encore une fois, afin de répondre aux exigences de l’énoncé, nous avons représenté la proportion de tirs ayant donné lieu à des buts, mais ici une représentation du nombre de tirs et de buts aurait été utile. Par exemple, les deux représentations donnent à penser que le tir de type &lt;em&gt;wrap around&lt;/em&gt; est extrêmement redoutable à grande distance. Ceci est une anomalie dans les données car il n’existe qu’un seul point de ce type. D’autant qu’un tir &lt;em&gt;wrap around&lt;/em&gt; à longue distance ne semble pas vraiment avoir de sens.&lt;/p&gt;

&lt;p&gt;Cela dit, on constate que le type de tir le plus efficace dépend grandement de la distance. À courte distance, les tirs les plus efficaces identifiés plus haut sont redoutables, par exemple &lt;em&gt;deflected&lt;/em&gt; et &lt;em&gt;tip in&lt;/em&gt;. Par contre, à plus longue distance, des types de tir qui ne ressortaient pas vraiment initialement semblent les plus efficaces, en particulier le &lt;em&gt;wrist shot&lt;/em&gt; et le &lt;em&gt;backhand&lt;/em&gt;.&lt;/p&gt;

</content>
 </entry>
 
 <entry>
   <title>Données Propes</title>
   <link href="http://localhost:4000/2022/10/10/tidy-data/"/>
   <updated>2022-10-10T00:00:00-04:00</updated>
   <id>http://localhost:4000/2022/10/10/tidy-data</id>
   <content type="html">&lt;p&gt;Voici le format final de nos données:
&lt;img src=&quot;figures/clean_data.png&quot; alt=&quot;Clean Data&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;powerplays&quot;&gt;PowerPlays&lt;/h2&gt;
&lt;p&gt;Chaque match commence avec le même nombre de joueurs et les joueurs sont enlevés du terrain suite à des pénalités. Il serait donc envisageable de calculer, à l’aide des timestamps et des événements définissants les différents penalités, combien de joueurs il y a sur le terrain pour chaque évenement. Les évenements de types “Penalty” stockent les durées des pénalties (“penaltyMinutes”) permettant de détérminer quand les forces se rééquilibrent.&lt;/p&gt;

&lt;h2 id=&quot;fonctionnalitées-supplémentaires&quot;&gt;Fonctionnalitées Supplémentaires&lt;/h2&gt;
&lt;p&gt;En plus des events qui ont été sélectionnés il serait interessant de considérer les ‘Missed Shots’ et ‘Blocked Shots’ pour analyser si elles sont ratées parce qu’elles sont prises à une certaine distance. On pourrait aussi envisager qu’il y ait une correlation entre le nombre de penalties d’une équipe et le nombre de shots pris. Finalement, nous avons choisis de tirer les données sur les joueurs qui ont participé aux tirs afin de déterminer et inclur le taux de reussite.&lt;/p&gt;

</content>
 </entry>
 
 <entry>
   <title>Debugger</title>
   <link href="http://localhost:4000/2022/10/10/debugger/"/>
   <updated>2022-10-10T00:00:00-04:00</updated>
   <id>http://localhost:4000/2022/10/10/debugger</id>
   <content type="html">&lt;p&gt;Nous avons ici un déboggueur qui charge les fichiers .JSON bruts et qui affiche les jeux. Le code permet de charger de manière dynamique les .JSON.&lt;/p&gt;

&lt;p&gt;La classe &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Data&lt;/code&gt; permet de storer des données entre les appels de la fonction et simplifie les opérations.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-Python&quot;&gt;class Data:
    &quot;&quot;&quot;
    Stateful class to store data and print information
    &quot;&quot;&quot;
    year: int = None
    game_id: int = None
    play_id: int = None
    _data: dict = None

    def set(self, year, game_id, play_id):
        # only load large json data (&amp;gt;100MB) of needed
        if year != self.year:
            with open(f&apos;../data/raw/{year}.json&apos;, &apos;r&apos;) as f:
                self._data = json.load(f)

        self.year = year
        self.game_id = game_id
        self.play_id = play_id

    def display(self):
        display(
            self._data[self.game_id][&apos;liveData&apos;][&apos;plays&apos;][&apos;allPlays&apos;][self.play_id]
        )

    def update_plot(self, fig: plt.figure, circle: plt.Circle):
        coords = self._data[self.game_id][&apos;liveData&apos;][&apos;plays&apos;][&apos;allPlays&apos;][self.play_id][&apos;coordinates&apos;]
        if coords:
            circle.set(visible=True, center=(coords[&apos;x&apos;], coords[&apos;y&apos;]))
        else:
            circle.set(visible=False)
        fig.canvas.draw()
        display.display(plt.gcf())
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;La boucle principale &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;plot&lt;/code&gt; permet de faire les bons appels selon ce qui est à démontrer&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-Python&quot;&gt;%matplotlib notebook
fig, ax = plt.subplots()

img_data = plt.imread(&apos;../blog/figures/nhl_rink.png&apos;)
img = plt.imshow(img_data, extent=[-100,100,-42.5,42.5])

circle = plt.Circle((0,0), 5, color=&apos;r&apos;)
ax.add_patch(circle)

data = Data()

@interact(
    year=[(&quot;2016-2017&quot;, 20162017), (&quot;2017-2018&quot;, 20172018)],
    game_id=(0,1200),
    play_id=(0,500),
)
def plot(year, game_id, play_id):
    data.set(year, game_id, play_id)
    data.display()
    data.update_plot(fig, circle)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&quot;figures/debugger.png&quot; alt=&quot;debugger&quot; /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Téléchargement de Données</title>
   <link href="http://localhost:4000/2022/10/09/data-download/"/>
   <updated>2022-10-09T00:00:00-04:00</updated>
   <id>http://localhost:4000/2022/10/09/data-download</id>
   <content type="html">&lt;p&gt;Éxécuter le notebook &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;notebooks/data_extraction.ipynb&lt;/code&gt; qui fait les actions suivantes:&lt;/p&gt;
&lt;ol&gt;
  &lt;li&gt;télécharge les données brutes à &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;../data/raw/[YEARYEAR].json&lt;/code&gt; sous format .JSON&lt;/li&gt;
  &lt;li&gt;nettoie les données et sauvegarde sous &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;../data/tabular/&lt;/code&gt; en format csv.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Voici le code exécuté par le notebook:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-Python&quot;&gt;from ift6758 import NHLLoader, NHCleaner

# Either download from API or extracted data from GDrive
NHLLoader.from_api(out_dir=&apos;../data/raw/&apos;)
# OR
NHLLoader.from_gdrive(out_dir=&quot;../data/raw/&quot;)

for season in [
    20162017,
    20172018,
    ...
]:
    df = NHLCleaner.format_season(f&apos;../data/raw/{season}.json&apos;)
    df.to_csv(f&apos;../data/tabular/{season}.csv&apos;, index=False)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Nous avons ajouté une méthode pour télécharger les données directement de GDrive afin de ne pas spam l’API de la LNH.&lt;/p&gt;

&lt;p&gt;Si vous ne voulez pas télécharger notre code python et l’installer en tant que package, vous pouvez aussi consulter le code source dans notre répertoire GitHub.&lt;/p&gt;
</content>
 </entry>
 

</feed>
