<!DOCTYPE html>
<html lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      IFT6758 Blog &middot; A template based on the Lanyon Jekyll theme
    
  </title>

  
  <link rel="canonical" href="http://localhost:4000/page2/">
  

  <link rel="stylesheet" href="http://localhost:4000/public/css/poole.css">
  <link rel="stylesheet" href="http://localhost:4000/public/css/syntax.css">
  <link rel="stylesheet" href="http://localhost:4000/public/css/lanyon.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700%7CPT+Sans:400">

  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://localhost:4000/public/apple-touch-icon-precomposed.png">
  <link rel="shortcut icon" href="http://localhost:4000/public/favicon.ico">

  <link rel="alternate" type="application/rss+xml" title="RSS" href="http://localhost:4000/atom.xml">

  
</head>


  <body>

    <!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
     styles, `#sidebar-checkbox` for behavior. -->
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">

<!-- Toggleable sidebar -->
<div class="sidebar" id="sidebar">
  <div class="sidebar-item">
    <p>A reserved <a href="https://jekyllrb.com" target="_blank">Jekyll</a> theme that places the utmost gravity on content with a hidden drawer. Made by <a href="https://twitter.com/mdo" target="_blank">@mdo</a>.</p>
  </div>

  <nav class="sidebar-nav">
    <a class="sidebar-nav-item active" href="http://localhost:4000/">Home</a>

    

    
    
      
        
      
    
      
        
      
    
      
        
          <a class="sidebar-nav-item" href="http://localhost:4000/about/">About</a>
        
      
    
      
    
      
        
      
    

    <span class="sidebar-nav-item">Currently v1.1.0</span>
  </nav>

  <div class="sidebar-item">
    <p>
      &copy; 2022. All rights reserved.
    </p>
  </div>
</div>


    <!-- Wrap is the content to shift when toggling the sidebar. We wrap the
         content to avoid any CSS collisions with our real content. -->
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <h3 class="masthead-title">
            <a href="/" title="Home">IFT6758 Blog</a>
            <small>A template based on the Lanyon Jekyll theme</small>
          </h3>
        </div>
      </div>

      <div class="container content">
        <div class="posts">
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://localhost:4000/2022/10/19/visu-complexe/">
        Visualizations Complexes
      </a>
    </h1>

    <span class="post-date">19 Oct 2022</span>

    <!--
Exportez les 4 tracés de zone offensive au format HTML et intégrez-les dans votre article de blog. Votre parcelle doit permettre aux utilisateurs de sélectionner n’importe quelle équipe au cours de la saison sélectionnée. Note: Parce que vous pouvez trouver ces chiffres sur internet, répondre à ces questions sans produire ces chiffres ne vous rapportera pas de points !
-->

<h2 id="densité-de-tirs">Densité de tirs</h2>

<p>Le graphique montre la densité de tirs sur la glace pour une équipe/saison donnée. La moyenne (blanche) est la moyenne de tirs de toutes les équipes pour une saison donnée. On peut voir les régions chaudes (en rouge) qui représentent des régions ou plus de but ont été marqués que la moyenne des équipe. En bleu on a l’opposé, soit en-dessous de la moyenne.</p>

<p>Dans ces graphes, on peut voir de quel régions les différentes équipes arrivent à marquer leurs buts. Est-ce qu’il s’agit d’une équipe qui amrque beaucoup de buts à proximitée de manière aggresive, qui domine le centre de la glace, ou est-ce plutôt une équipe qui préfère tirer souvent, mais de loin avec des coups du poignet.</p>

<p>Ceci nous permet de voir l’efficacité des startégies et les différentes faiblesses des équipes.</p>

<p>Select Season<br />
Fixed to 2016-2018 for hand-in due to filesize exceeding gradescope limits otherwise</p>

<p><select id="season" onchange="refreshplot()">
	<option value="20162017">2016-2017</option>
	<option value="20172018">2017-2018</option>
</select></p>

<p>Select Team 
<select id="team" onchange="refreshplot()">
	<option value="">..</option>
	<option value="ANA">Mighty Ducks of Anaheim/Anaheim Ducks</option>
	<option value="ARI">Arizona Coyotes</option>
	<option value="BOS">Boston Bruins</option>
	<option value="BUF">Buffalo Sabres</option>
	<option value="CAR">Carolina Hurricanes</option>
	<option value="CBJ">Columbus Blue Jackets</option>
	<option value="CGY">Calgary Flames</option>
	<option value="CHI">Chicago Black Hawks/Blackhawks</option>
	<option value="COL">Colorado Avalanche</option>
	<option value="DAL">Dallas Stars</option>
	<option value="DET">Detroit Red Wings</option>
	<option value="EDM">Edmonton Oilers</option>
	<option value="FLA">Florida Panthers</option>
	<option value="LAK">Los Angeles Kings</option>
	<option value="MIN">Minnesota Wild</option>
	<option value="MTL">Montreal Canadiens</option>
	<option value="NJD">New Jersey Devils</option>
	<option value="NSH">Nashville Predators</option>
	<option value="NYI">New York Islanders</option>
	<option value="NYR">New York Rangers</option>
	<option value="OTT">Ottawa Senators</option>
	<option value="PHI">Philadelphia Flyers</option>
	<option value="PIT">Pittsburgh Penguins</option>
	<option value="SJS">San Jose Sharks</option>
	<option value="STL">St. Louis Blues</option>
	<option value="TBL">Tampa Bay Lightning</option>
	<option value="TOR">Toronto Maple Leafs</option>
	<option value="VAN">Vancouver Canucks</option>
	<option value="WPG">Winnipeg Jets</option>
	<option value="WSH">Washington Capitals</option>
</select></p>
<iframe id="iframe" src="/plots/blank.html" style="height:830px;width:100%; border:dotted 1px #999;" title="plot"></iframe>
<script>
	function refreshplot(){
		let season = document.getElementById('season').value;
		let team   = document.getElementById('team').value;
		let ifrm   = document.getElementById('iframe');
        if((season=='')||(team=='')){
            ifrm.src = 'plots/blank.html';
        }else{
        	ifrm.src = 'plots/plotly_'+season+'_'+team+'.html';
        }
	}
</script>

<hr />

<!--
Considérez l’Avalanche du Colorado; jetez un œil à leur carte de tir au cours de la saison 2016-17. Discutez de ce que vous pourriez dire sur l’équipe au cours de cette saison. Regardez maintenant la carte des plans de l’Avalanche du Colorado pour la saison 2020-21 et discutez de ce que vous pourriez conclure de ces différences. Est-ce que ça a du sens? Astuce : regardez le classement.
-->
<h3 id="avalanche-colorado--une-stratégie-gagnante">Avalanche Colorado : une stratégie gagnante</h3>

<table>
  <thead>
    <tr>
      <th>Season 2016-2017</th>
      <th>season 2020-2021</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><img src="plots/COL_2016.png" alt="2016-2017" /></td>
      <td><img src="plots/COL_2020.png" alt="2020-2021" /></td>
    </tr>
  </tbody>
</table>

<p>Les avalanches se situaient en dernière place de leur division en 2016-2017 et on fait une remontée fulgurante en 2020-2021 pour se hisser au top de leur classement. On peut voir qu’ils avaient de la difficulté auparavant à s’approcher du gardien et que la majoritée de leurs buts étaient marqués de loin.</p>

<p>Leur stratégie dans la dernière saison a beaucoup évoluée et ils sont désormais capables de s’approcher du but ce qui leur donne davantage d’occasions de marquer.</p>

<hr />

<h3 id="buffalo-sabres-vs-tampa-lighting">Buffalo Sabres vs. Tampa Lighting</h3>

<table>
  <thead>
    <tr>
      <th>Year</th>
      <th>Buffalo Sabres</th>
      <th>Tampa Lighting</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2018-2019</td>
      <td><img src="plots/BUF_2018.png" alt="2018" /></td>
      <td><img src="plots/TBL_2018.png" alt="2018" /></td>
    </tr>
    <tr>
      <td>2019-2020</td>
      <td><img src="plots/BUF_2019.png" alt="2019" /></td>
      <td><img src="plots/TBL_2019.png" alt="2019" /></td>
    </tr>
    <tr>
      <td>2020-2021</td>
      <td><img src="plots/BUF_2020.png" alt="2020" /></td>
      <td><img src="plots/TBL_2020.png" alt="2020" /></td>
    </tr>
  </tbody>
</table>

<p>La comparaison côte-à-côte montre que le Lightning, qui connait beaucoup de succès, priorise des tris proche du centre de la glace et proche du gardien. Ils réussissent donc à déjouer la défence et s’approcher du but, ce qui leur donne un beaucoup plus haut taux de succès.</p>

<p>Buffalo quand a eux on des tirs beaucoup plus disparates avec un faible taux de succès. Leurs régions à haute densitée de succès sont beaucoup plus disparates.</p>

<p>Il semble facile d’expliquer la différence de perforamnce selon ces graphiques!</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://localhost:4000/2022/10/18/visu-simple/">
        Visualisations simples
      </a>
    </h1>

    <span class="post-date">18 Oct 2022</span>

    <h2 id="types-de-tir">Types de tir</h2>

<p>Dans le respect des consignes, qui exigeaient de superposer le nombre de tirs et le nombre de buts de chaque type, nous avons réalisé un diagramme à barres empilées où chaque barre représente un type de tir. Cependant, puique plusieurs questions ont été posé en même temps, il est évident qu’un graphique par question serait idéal.</p>

<p><img src="figures/q5-1.png" alt="Histogramme des tirs et buts en fonction du type de tir (saison 2016-2017)" /></p>

<p>On constate que le <em>wrist shot</em> est le type le plus courant, suivi loin derrière par les <em>slap shots</em> et les <em>snap shots</em>. Le diagramme montre que <em>wrist shots</em> et les <em>snap shots</em> sont particulièrement redoutables en termes absolut. Par contre les données démontrent que ce ne sont pas les types de tir qui se traduisent par le plus haut taux de succès.</p>

<p>Une visualisation combinant, par exemple, une barre représentant le nombre de tirs de chaque type accompagné d’une ligne représentant la <em>proportion</em> de ces tirs résultant en un but aurait été plus parlante, et aurait par exemple révélé que les types de tir les plus redoutables sont <em>deflected</em> et <em>tip-in</em>.</p>

<h2 id="distance-de-tir">Distance de tir</h2>

<p>Pour cette question, nous avons choisi de présenter des histogrammes, où chaque barre représente une classe de distances et indique la proportion de tirs se traduisant en buts. Initialement, nous avions laissé à la bibliothèque pandas le soin  de délimiter les classes, mais le résultat nuisait à la lisibilité. Si nous avions utilisé des quartiles, nous aurions perdu certaines nuances intéressantes dans les données. Les déciles auraient donné des bornes moins interprétables pour les classes. Au final, nous avons opté pour des classes représentant chacune un intervalle de dix pieds de distance.</p>

<p>On voit dans l’ensemble que, jusqu’à une distance de 70 pieds, plus un tir est effectué proche de la cible, plus il a de chances de se traduire en but. Ce n’est pas un constat très surprenant, car on peut penser qu’il est plus facile de viser avec précision d’une distance moins grande, et que de plus moins de joueurs ont l’opportunité de s’interposer entre le tireur et le gardien pour tenter d’intercepter la rondelle.</p>

<p>En regardant les graphiques, on constate cependant deux phénomènes étonnants.</p>

<p><img src="figures/q5-2-20182019.png" alt="Histogramme des buts en fonction de la distance (saison 2018-2019)" />
<img src="figures/q5-2-20192020.png" alt="Histogramme des buts en fonction de la distance (saison 2019-2020)" />
<img src="figures/q5-2-20202021.png" alt="Histogramme des buts en fonction de la distance (saison 2020-2021)" /></p>

<p>D’une part, au-delà de 70 pieds, les tirs semblent reprendre en efficacité. En effet, de 2018 à 2022, les tirs d’entre 90 et 100 pieds sont en fait plus efficaces que les tirs d’entre 40 et 50 pieds. En 2020-2021, ce sont plutôt les tirs d’entre 80 et 90 pieds qui présentent cette caractéristique. Dans toutes ces années, les tirs de plus de 70 pieds de distance sont plus efficaces en moyenne que ceux de 60 à 70 pieds. La présente visualisation ne permet par contre par de tenir compte de différents facteurs qui pourraient expliquer cela. Par exemple, est-il possible que les attaquants aient une propension plus grande à tirer de loin dans un filet désert, ou encore quand, suite à une échappée, ils ne font pas face à des défenseurs qui pourraient s’interposer? Ces deux facteurs et d’autres sans doute permettraient d’expliquer au moins en partie pourquoi les tirs de loin semblent plus efficaces que ceux de distance moyenne.</p>

<p>D’autre part, on remarque une différence assez importante au niveau du taux de succès des tirs les plus proches entre la saison 2018-2019 et les saisons subséquentes. Sur la base des donnés à notre disposition, nous ne nous considérons pas en mesure de faire d’hypothèses sur la raison qui explique cette différence.</p>

<h2 id="types-et-distance-de-tir">Types et distance de tir</h2>

<p>Nous avons utilisé deux types de visualisation pour cette question. Le diagramme en aires est plus facile à lire de façon générale, mais certains <em>insights</em> n’en ressortent pas aussi bien. Un diagramme tridimensionnel présentant la distance et le type de tir sur chacun des deux axes horizontaux et la proportion de succès sur l’axe vertical est plus difficile à lire, mais fait ressortir certains points intéressants.</p>

<p><img src="figures/q5-3.png" alt="Graphie en aires des buts en fonction du type de tir et de la distance (saison 2016-2017)" />
<img src="figures/q5-3-stacked.png" alt="Graphie en aires des buts en fonction du type de tir et de la distance (saison 2016-2017)" /></p>

<p>Encore une fois, afin de répondre aux exigences de l’énoncé, nous avons représenté la proportion de tirs ayant donné lieu à des buts, mais ici une représentation du nombre de tirs et de buts aurait été utile. Par exemple, les deux représentations donnent à penser que le tir de type <em>wrap around</em> est extrêmement redoutable à grande distance. Ceci est une anomalie dans les données car il n’existe qu’un seul point de ce type. D’autant qu’un tir <em>wrap around</em> à longue distance ne semble pas vraiment avoir de sens.</p>

<p>Cela dit, on constate que le type de tir le plus efficace dépend grandement de la distance. À courte distance, les tirs les plus efficaces identifiés plus haut sont redoutables, par exemple <em>deflected</em> et <em>tip in</em>. Par contre, à plus longue distance, des types de tir qui ne ressortaient pas vraiment initialement semblent les plus efficaces, en particulier le <em>wrist shot</em> et le <em>backhand</em>.</p>


  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://localhost:4000/2022/10/10/tidy-data/">
        Données Propes
      </a>
    </h1>

    <span class="post-date">10 Oct 2022</span>

    <p>Voici le format final de nos données:
<img src="figures/clean_data.png" alt="Clean Data" /></p>

<h2 id="powerplays">PowerPlays</h2>
<p>Chaque match commence avec le même nombre de joueurs et les joueurs sont enlevés du terrain suite à des pénalités. Il serait donc envisageable de calculer, à l’aide des timestamps et des événements définissants les différents penalités, combien de joueurs il y a sur le terrain pour chaque évenement. Les évenements de types “Penalty” stockent les durées des pénalties (“penaltyMinutes”) permettant de détérminer quand les forces se rééquilibrent.</p>

<h2 id="fonctionnalitées-supplémentaires">Fonctionnalitées Supplémentaires</h2>
<p>En plus des events qui ont été sélectionnés il serait interessant de considérer les ‘Missed Shots’ et ‘Blocked Shots’ pour analyser si elles sont ratées parce qu’elles sont prises à une certaine distance. On pourrait aussi envisager qu’il y ait une correlation entre le nombre de penalties d’une équipe et le nombre de shots pris. Finalement, nous avons choisis de tirer les données sur les joueurs qui ont participé aux tirs afin de déterminer et inclur le taux de reussite.</p>


  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://localhost:4000/2022/10/10/debugger/">
        Debugger
      </a>
    </h1>

    <span class="post-date">10 Oct 2022</span>

    <p>Nous avons ici un déboggueur qui charge les fichiers .JSON bruts et qui affiche les jeux. Le code permet de charger de manière dynamique les .JSON.</p>

<p>La classe <code class="language-plaintext highlighter-rouge">Data</code> permet de storer des données entre les appels de la fonction et simplifie les opérations.</p>

<pre><code class="language-Python">class Data:
    """
    Stateful class to store data and print information
    """
    year: int = None
    game_id: int = None
    play_id: int = None
    _data: dict = None

    def set(self, year, game_id, play_id):
        # only load large json data (&gt;100MB) of needed
        if year != self.year:
            with open(f'../data/raw/{year}.json', 'r') as f:
                self._data = json.load(f)

        self.year = year
        self.game_id = game_id
        self.play_id = play_id

    def display(self):
        display(
            self._data[self.game_id]['liveData']['plays']['allPlays'][self.play_id]
        )

    def update_plot(self, fig: plt.figure, circle: plt.Circle):
        coords = self._data[self.game_id]['liveData']['plays']['allPlays'][self.play_id]['coordinates']
        if coords:
            circle.set(visible=True, center=(coords['x'], coords['y']))
        else:
            circle.set(visible=False)
        fig.canvas.draw()
        display.display(plt.gcf())
</code></pre>

<p>La boucle principale <code class="language-plaintext highlighter-rouge">plot</code> permet de faire les bons appels selon ce qui est à démontrer</p>

<pre><code class="language-Python">%matplotlib notebook
fig, ax = plt.subplots()

img_data = plt.imread('../blog/figures/nhl_rink.png')
img = plt.imshow(img_data, extent=[-100,100,-42.5,42.5])

circle = plt.Circle((0,0), 5, color='r')
ax.add_patch(circle)

data = Data()

@interact(
    year=[("2016-2017", 20162017), ("2017-2018", 20172018)],
    game_id=(0,1200),
    play_id=(0,500),
)
def plot(year, game_id, play_id):
    data.set(year, game_id, play_id)
    data.display()
    data.update_plot(fig, circle)
</code></pre>

<p><img src="figures/debugger.png" alt="debugger" /></p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://localhost:4000/2022/10/09/data-download/">
        Téléchargement de Données
      </a>
    </h1>

    <span class="post-date">09 Oct 2022</span>

    <p>Éxécuter le notebook <code class="language-plaintext highlighter-rouge">notebooks/data_extraction.ipynb</code> qui fait les actions suivantes:</p>
<ol>
  <li>télécharge les données brutes à <code class="language-plaintext highlighter-rouge">../data/raw/[YEARYEAR].json</code> sous format .JSON</li>
  <li>nettoie les données et sauvegarde sous <code class="language-plaintext highlighter-rouge">../data/tabular/</code> en format csv.</li>
</ol>

<p>Voici le code exécuté par le notebook:</p>
<pre><code class="language-Python">from ift6758 import NHLLoader, NHCleaner

# Either download from API or extracted data from GDrive
NHLLoader.from_api(out_dir='../data/raw/')
# OR
NHLLoader.from_gdrive(out_dir="../data/raw/")

for season in [
    20162017,
    20172018,
    ...
]:
    df = NHLCleaner.format_season(f'../data/raw/{season}.json')
    df.to_csv(f'../data/tabular/{season}.csv', index=False)
</code></pre>

<p>Nous avons ajouté une méthode pour télécharger les données directement de GDrive afin de ne pas spam l’API de la LNH.</p>

<p>Si vous ne voulez pas télécharger notre code python et l’installer en tant que package, vous pouvez aussi consulter le code source dans notre répertoire GitHub.</p>

  </div>
  
</div>

<div class="pagination">
  
    <span class="pagination-item older">Older</span>
  
  
    
      <a class="pagination-item newer" href="http://localhost:4000/">Newer</a>
    
  
</div>

      </div>
    </div>

    <label for="sidebar-checkbox" class="sidebar-toggle"></label>

    <script src='/public/js/script.js'></script>
  </body>
</html>
